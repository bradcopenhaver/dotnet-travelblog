@model IEnumerable<TravelBlogAgain.Models.Location>

@{
    ViewData["Title"] = "Travel Blog";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Welcome to Indy's Travel Blog</h2>

<div class="row">
    <div class="col-sm-8">
        <h3>Places I've been:</h3>
        @foreach ( var location in Model)
        {
            <h4>@Html.DisplayFor(locationItem => location.Name)</h4>
            <h6>@Html.ActionLink("Edit Location", "Edit", new { id = location.LocationId}) | @Html.ActionLink("Delete Location", "Delete", new { id = location.LocationId })</h6>
            @foreach (var experience in location.Experiences)
            {
                <h5>@Html.ActionLink(experience.Activity, "Details", "Experiences", new { id = experience.ExpId })</h5>

            }

        }
        @Html.ActionLink("Create New Location", "Create") |
        @Html.ActionLink("Create New Experience", "Create", "Experiences")
    </div>
    <div class="col-sm-4">
        <h3>Places I should go:</h3>
        @foreach (var suggestion in ViewBag.Suggestions)
        {
            <h4>@suggestion.Name</h4>
            <input type="submit" id="@suggestion.Id" class="add-upvote btn" value="Upvote!" />
            <h6>Upvotes: 
                <span id='@("result" + suggestion.Id)'>
                    @suggestion.Upvotes
                </span>
           </h6>
        }
        <h5>@Html.ActionLink("Make a Suggestion", "Create", "Suggestions")</h5>
    </div>
</div>


<script type="text/javascript">
    $(document).ready(function () {
        $('.add-upvote').click(function (event) {
            var clickedId = $(this).attr('id');
            event.preventDefault();
            console.log("oh, hi");
            $.ajax({
                url: '@Url.Action("AddUpvote", "Suggestions")',
                type: 'POST',
                //dataType: 'json',
                data: { id: clickedId },
                success: function (result) {
                    $('#result' + clickedId).text(result);
                }
            });
        });
    });
</script>